"use strict";(self["webpackChunkh990"]=self["webpackChunkh990"]||[]).push([[162],{1570:function(e,t,a){a.d(t,{Z:function(){return r}});var i=a(3396),l={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512.5 390.6c-29.9 0-57.9 11.6-79.1 32.8-21.1 21.2-32.8 49.2-32.8 79.1 0 29.9 11.7 57.9 32.8 79.1 21.2 21.1 49.2 32.8 79.1 32.8 29.9 0 57.9-11.7 79.1-32.8 21.1-21.2 32.8-49.2 32.8-79.1 0-29.9-11.7-57.9-32.8-79.1a110.96 110.96 0 00-79.1-32.8zm412.3 235.5l-65.4-55.9c3.1-19 4.7-38.4 4.7-57.7s-1.6-38.8-4.7-57.7l65.4-55.9a32.03 32.03 0 009.3-35.2l-.9-2.6a442.5 442.5 0 00-79.6-137.7l-1.8-2.1a32.12 32.12 0 00-35.1-9.5l-81.2 28.9c-30-24.6-63.4-44-99.6-57.5l-15.7-84.9a32.05 32.05 0 00-25.8-25.7l-2.7-.5c-52-9.4-106.8-9.4-158.8 0l-2.7.5a32.05 32.05 0 00-25.8 25.7l-15.8 85.3a353.44 353.44 0 00-98.9 57.3l-81.8-29.1a32 32 0 00-35.1 9.5l-1.8 2.1a445.93 445.93 0 00-79.6 137.7l-.9 2.6c-4.5 12.5-.8 26.5 9.3 35.2l66.2 56.5c-3.1 18.8-4.6 38-4.6 57 0 19.2 1.5 38.4 4.6 57l-66 56.5a32.03 32.03 0 00-9.3 35.2l.9 2.6c18.1 50.3 44.8 96.8 79.6 137.7l1.8 2.1a32.12 32.12 0 0035.1 9.5l81.8-29.1c29.8 24.5 63 43.9 98.9 57.3l15.8 85.3a32.05 32.05 0 0025.8 25.7l2.7.5a448.27 448.27 0 00158.8 0l2.7-.5a32.05 32.05 0 0025.8-25.7l15.7-84.9c36.2-13.6 69.6-32.9 99.6-57.5l81.2 28.9a32 32 0 0035.1-9.5l1.8-2.1c34.8-41.1 61.5-87.4 79.6-137.7l.9-2.6c4.3-12.4.6-26.3-9.5-35zm-412.3 52.2c-97.1 0-175.8-78.7-175.8-175.8s78.7-175.8 175.8-175.8 175.8 78.7 175.8 175.8-78.7 175.8-175.8 175.8z"}}]},name:"setting",theme:"filled"},s=l,d=a(9388);function n(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?Object(arguments[t]):{},i=Object.keys(a);"function"===typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(a).filter((function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable})))),i.forEach((function(t){c(e,t,a[t])}))}return e}function c(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var m=function(e,t){var a=n({},e,t.attrs);return(0,i.Wm)(d.Z,n({},a,{icon:s}),null)};m.displayName="SettingFilled",m.inheritAttrs=!1;var r=m},8162:function(e,t,a){a.r(t),a.d(t,{default:function(){return j}});var i=a(3396),l=a(7139),s=a(9242);const d={class:"d-flex"},n={class:"vh-100 time-bar-group"},c={class:"ps-3 time-title py-2 border-bottom border-end"},m={class:"time-menu-height"},r={class:"time-menu border-end bg-white"},o=["onClick"],u={class:"time-group"},p={class:"ps-3 d-flex align-items-center time-title py-2 border-bottom w-100"},h={class:"p-sm-4 p-2"},k={class:"position-relative"},w={key:0,class:"position-absolute text-white d-flex align-items-center justify-content-center",style:{top:"0",bottom:"0",left:"0",right:"0","background-color":"rgba(0, 0, 0, 0.55)","z-index":"100"}},y={key:0,class:"ms-2"},v={key:1},f={key:2},b={key:3,class:"editable-row-operations"},_={key:0},g={key:1};function D(e,t,a,D,$,x){const W=(0,i.up)("a-menu-item"),N=(0,i.up)("a-menu"),O=(0,i.up)("setting-filled"),C=(0,i.up)("edit-outlined"),M=(0,i.up)("a-menu-divider"),U=(0,i.up)("delete-outlined"),z=(0,i.up)("a-dropdown"),F=(0,i.up)("a-button"),T=(0,i.up)("a-table-column"),j=(0,i.up)("a-date-picker"),Y=(0,i.up)("a-select-option"),I=(0,i.up)("a-select"),K=(0,i.up)("a-typography-link"),S=(0,i.up)("a-divider"),R=(0,i.up)("a-popconfirm"),P=(0,i.up)("a-table"),Z=(0,i.up)("a-input"),q=(0,i.up)("a-form-item"),E=(0,i.up)("a-form"),H=(0,i.up)("a-modal");return(0,i.wg)(),(0,i.iD)("div",null,[(0,i._)("div",d,[(0,i._)("div",n,[(0,i._)("div",c,(0,l.zw)(e.$t("time")),1),(0,i._)("div",m,[(0,i._)("div",r,[(0,i.Wm)(N,{class:"border-end-0",selectedKeys:$.selectedKeys,"onUpdate:selectedKeys":t[1]||(t[1]=e=>$.selectedKeys=e),mode:"inline"},{default:(0,i.w5)((()=>[(0,i.Wm)(W,{key:"add"},{default:(0,i.w5)((()=>[(0,i._)("a",{href:"#",onClick:t[0]||(t[0]=(0,s.iM)((e=>x.changeTemp("add")),["prevent"]))},(0,l.zw)(e.$t("add")),1)])),_:1}),$.data&&$.data.length>0?((0,i.wg)(!0),(0,i.iD)(i.HY,{key:0},(0,i.Ko)($.data,((e,t)=>((0,i.wg)(),(0,i.j4)(W,{key:e.makeup_name},{default:(0,i.w5)((()=>[(0,i._)("a",{href:"#",onClick:(0,s.iM)((a=>x.changeTemp(e,t)),["prevent"])},(0,l.zw)(e.makeup_name),9,o)])),_:2},1024)))),128)):(0,i.kq)("",!0)])),_:1},8,["selectedKeys"])])])]),(0,i._)("div",u,[(0,i._)("div",p,[(0,i._)("span",null,(0,l.zw)($.selectName),1),$.temp&&$.temp.makeup_name?((0,i.wg)(),(0,i.j4)(z,{key:0,trigger:["click"],class:"ms-2"},{overlay:(0,i.w5)((()=>[(0,i.Wm)(N,null,{default:(0,i.w5)((()=>[(0,i.Wm)(W,null,{default:(0,i.w5)((()=>[(0,i.Wm)(C,{class:"me-1"}),(0,i._)("a",{onClick:t[3]||(t[3]=(0,s.iM)((e=>$.visible=!0),["prevent"]))},(0,l.zw)(e.$t("修改補班表名稱")),1)])),_:1}),(0,i.Wm)(M),(0,i.Wm)(W,null,{default:(0,i.w5)((()=>[(0,i.Wm)(U,{class:"me-1",style:{color:"red"}}),(0,i._)("a",{onClick:t[4]||(t[4]=(0,s.iM)(((...e)=>x.deleteMakeup&&x.deleteMakeup(...e)),["prevent"])),style:{color:"red"}},(0,l.zw)(e.$t("刪除此補班表")),1)])),_:1})])),_:1})])),default:(0,i.w5)((()=>[(0,i._)("a",{class:"ant-dropdown-link setting-link",onClick:t[2]||(t[2]=(0,s.iM)((()=>{}),["prevent"]))},[(0,i.Wm)(O)])])),_:1})):(0,i.kq)("",!0)]),(0,i._)("div",h,[(0,i._)("div",k,[$.temp.makeup_name||$.visible?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("div",w,(0,l.zw)(e.$t("請先點選左側新增")),1)),(0,i.Wm)(F,{class:"mb-auto",type:"primary",onClick:x.addNew},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(e.$t("add")),1)])),_:1},8,["onClick"]),$.temp?((0,i.wg)(),(0,i.j4)(P,{key:1,"data-source":$.temp.make_up_date,class:"mt-2",size:"small",pagination:{size:"middle","show-quick-jumper":!0,defaultPageSize:15,position:["bottomLeft"]},bordered:""},{bodyCell:(0,i.w5)((({column:t,record:a,index:s})=>["index"===t.key?((0,i.wg)(),(0,i.iD)("span",y,(0,l.zw)(s+1),1)):(0,i.kq)("",!0),"date"===t.key?((0,i.wg)(),(0,i.iD)("div",v,[$.editableData[a.date]?((0,i.wg)(),(0,i.j4)(j,{key:0,valueFormat:"YYYY-MM-DD",value:$.editableData[a.date].date,"onUpdate:value":e=>$.editableData[a.date].date=e},null,8,["value","onUpdate:value"])):((0,i.wg)(),(0,i.iD)(i.HY,{key:1},[(0,i.Uk)((0,l.zw)(a.date),1)],64))])):"weekday"===t.key?((0,i.wg)(),(0,i.iD)("div",f,[$.editableData[a.date]?((0,i.wg)(),(0,i.j4)(I,{key:0,value:$.editableData[a.date].weekday,"onUpdate:value":e=>$.editableData[a.date].weekday=e,style:{width:"120px"}},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)($.renderDay,(t=>((0,i.wg)(),(0,i.j4)(Y,{key:t,value:t},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(e.$t(t)),1)])),_:2},1032,["value"])))),128))])),_:2},1032,["value","onUpdate:value"])):((0,i.wg)(),(0,i.iD)(i.HY,{key:1},[(0,i.Uk)((0,l.zw)(e.$t(a.weekday)),1)],64))])):"action"===t.key?((0,i.wg)(),(0,i.iD)("div",b,[$.editableData[a.date]||""===$.editableData[a.date]?((0,i.wg)(),(0,i.iD)("span",_,[(0,i.Wm)(K,{onClick:e=>x.save(a.date,s)},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(e.$t("confirm")),1)])),_:2},1032,["onClick"]),(0,i.Wm)(S,{type:"vertical"}),(0,i.Wm)(K,{onClick:e=>x.cancel(a.date,s),type:"link"},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(e.$t("cancel")),1)])),_:2},1032,["onClick"])])):((0,i.wg)(),(0,i.iD)("span",g,[(0,i.Wm)(F,{title:e.$t("modify"),type:"text",onClick:e=>x.edit(a)},{icon:(0,i.w5)((()=>[(0,i.Wm)(C)])),_:2},1032,["title","onClick"]),(0,i.Wm)(R,{title:e.$t("wannaDelete"),onConfirm:e=>x.del(a.date,s)},{default:(0,i.w5)((()=>[(0,i.Wm)(K,{type:"danger"},{default:(0,i.w5)((()=>[(0,i.Wm)(F,{title:e.$t("Delete"),type:"text"},{icon:(0,i.w5)((()=>[(0,i.Wm)(U)])),_:1},8,["title"])])),_:1})])),_:2},1032,["title","onConfirm"])]))])):(0,i.kq)("",!0)])),default:(0,i.w5)((()=>[(0,i.Wm)(T,{class:"ps-3 text-nowrap table-bg-primary",width:"5%",title:"#",key:"index","data-index":"index"}),(0,i.Wm)(T,{class:"text-nowrap table-bg-primary",key:"date",title:e.$t("date"),"data-index":"date",sorter:(e,t)=>x.dayjs(e.date,"YYYY-MM-DD")-x.dayjs(t.date,"YYYY-MM-DD")},null,8,["title","sorter"]),(0,i.Wm)(T,{class:"text-nowrap table-bg-primary",key:"weekday",title:e.$t("make-upDay"),"data-index":"weekday",filters:[{text:e.$t("MON"),value:"MON"},{text:e.$t("TUE"),value:"TUE"},{text:e.$t("WED"),value:"WED"},{text:e.$t("THU"),value:"THU"},{text:e.$t("FRI"),value:"FRI"},{text:e.$t("SAT"),value:"SAT"},{text:e.$t("SUN"),value:"SUN"}],onFilter:(e,t)=>0===t.weekday.indexOf(e)},null,8,["title","filters","onFilter"]),(0,i.Wm)(T,{width:"22%",class:"text-nowrap table-bg-primary",title:e.$t("action"),key:"action","data-index":"action"},null,8,["title"])])),_:1},8,["data-source"])):(0,i.kq)("",!0)])])])]),(0,i.Wm)(H,{visible:$.visible,"onUpdate:visible":t[6]||(t[6]=e=>$.visible=e),title:e.$t("make-upTableFeedBack"),"ok-text":e.$t("save"),"cancel-text":e.$t("cancel"),onOk:x.onOk,onCancel:x.onCancel},{default:(0,i.w5)((()=>[(0,i.Wm)(E,{model:$.temp,ref:"makeupFormRef"},{default:(0,i.w5)((()=>[(0,i.Wm)(q,{class:"mb-2",label:e.$t("shiftname"),rules:[{required:!0,validator:x.validate,trigger:"change"}],name:"makeup_name"},{default:(0,i.w5)((()=>[(0,i.Wm)(Z,{value:$.temp.makeup_name,"onUpdate:value":t[5]||(t[5]=e=>$.temp.makeup_name=e)},null,8,["value"])])),_:1},8,["label","rules"])])),_:1},8,["model"])])),_:1},8,["visible","title","ok-text","cancel-text","onOk","onCancel"])])}a(1703),a(7658),a(541);var $=a(3318),x=a(681),W=a(1570),N=a(2574),O=a(2074),C=a(3495),M=a(5743),U=a.n(M),z=(a(5874),{components:{EditOutlined:$.Z,DeleteOutlined:x.Z,SettingFilled:W.Z},emits:["copyto"],data(){return{selectedKeys:[],data:[{id:1,make_up_date:[{date:"2023-01-07",weekday:"FRI"},{date:"2023-02-04",weekday:"FRI"},{date:"2023-02-18",weekday:"MON"},{date:"2023-03-25",weekday:"MON"}],makeup_id:"1",makeup_name:"正常班"}],editableData:{},renderDay:["MON","TUE","WED","THU","FRI","SAT","SUN"],temp:{makeup_name:" "},isNew:!1,selectIndex:0,selectName:"",visible:!1}},methods:{onCancel(){if(0===this.data.length)return this.selectedKeys=[],this.temp={},void(this.selectIndex=0);this.selectedKeys=[this.data[0].makeup_name],this.changeTemp(this.data[0],0)},onOk(){this.$refs.makeupFormRef.validateFields().then((()=>{this.visible=!1,this.selectName=this.temp.makeup_name,"add"!==this.selectedKeys[0]&&this.saveData()})).catch((()=>{this.$refs.makeupFormRef.scrollToField()}))},updateName(){this.visible=!0},async validate(e,t,a){if(!t)return Promise.reject(this.$t("requiredFeedback"));const i=this.data.find((e=>this.isNew?e.makeup_name===t:e.makeup_name===t&&t!==this.data[this.selectIndex].makeup_name));return i?Promise.reject(new Error(this.$t("nameRepeat"))):Promise.resolve()},dayjs:U(),saveData(){const e={...this.temp},t=this.isNew?"added":"update";this.isNew?this.data.push(e):this.data[this.selectIndex]=e,this.getData(),O.ZP.success(this.temp.makeup_name+" "+this.$t(t)+this.$t("success"),5),this.selectedKeys=[e.makeup_name]},deleteMakeup(){console.log(this.selectIndex),"add"!==this.selectedKeys[0]?C.Z.confirm({title:this.$t("wannaDelete"),icon:(0,i.Wm)(N.Z),okText:this.$t("confirm"),cancelText:this.$t("cancel"),content:()=>(0,i.h)("div",{},[(0,i.h)("strong",this.$t("deleteItem")),(0,i.h)("div",{class:"py-1"},this.$t("holidayGroup")+`：${this.temp.makeup_name}`)]),onOk:()=>{this.data.splice(this.selectIndex,1),this.getData("first"),O.ZP.success(this.temp.makeup_name+" "+this.$t("delete")+this.$t("success"),5)},onCancel(){}}):this.onCancel()},addNew(){this.editableData.new||(this.temp.make_up_date.unshift({date:"new",weekday:"MON"}),this.editableData.new={date:"",weekday:"MON"})},edit(e){this.editableData[e.date]={...e}},save(e,t){if(!this.editableData[e].date)return void alert(this.$t("dateFeedBack"));const a=this.temp.make_up_date.find(((a,i)=>a.date===this.editableData[e].date&&i!==t));a?alert(this.$t("dateRepeat")):(this.temp.make_up_date.splice(t,1,this.editableData[e]),delete this.editableData[e],this.saveData())},del(e,t){this.temp.make_up_date.splice(t,1),delete this.editableData[e],this.saveData()},cancel(e,t){"new"===e&&this.temp.make_up_date.splice(t,1),delete this.editableData[e]},changeTemp(e,t){this.editableData={},this.temp="add"===e?{makeup_name:"New Template",make_up_date:[]}:JSON.parse(JSON.stringify(e)),this.selectName=e.makeup_name,this.isNew="add"===e,this.selectIndex=t,"add"===e&&(this.visible=!0,this.addNew(),this.$refs.makeupFormRef&&this.$refs.makeupFormRef.clearValidate())},getData(e){if(0===this.data.length)return this.temp={},this.selectName="",void(this.selectIndex=0);if(e&&(this.selectedKeys=[this.data[0].makeup_name],this.changeTemp(this.data[0],0)),this.isNew){const e=this.data.length-1;this.changeTemp(this.data[e],e),this.isNew=!1}}},created(){this.getData("first")}}),F=a(89);const T=(0,F.Z)(z,[["render",D]]);var j=T}}]);